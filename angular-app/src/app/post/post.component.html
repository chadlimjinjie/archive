<div class="md:container md:mx-auto p-4">

    <!-- <p>post {{postId}} works!</p> -->

    <div *ngIf="post">
        <div class="bg-slate-800 p-4 rounded-lg mb-6 outline outline-offset-2 outline-slate-50">
            <div class="flex flex-row">

                <div class="flex flex-col mr-4">
                    <img class="rounded-full w-12 h-12"
                        src="https://www.bostonmagazine.com/wp-content/uploads/sites/2/2021/08/rubber-duck-stock-t.jpg" />

                    <div *ngIf="comments.length > 0 || post.openComment" class="flex-1 mt-2 ml-auto mr-auto bg-slate-50 w-px mb-2"></div>
                </div>

                <div class="flex flex-col flex-1">
                    <div class="flex flex-row">
                        <a *ngIf="post.user.username"
                            class="text-slate-50 font-bold mr-4 hover:underline pointer cursor-pointer">@{{post.user.username}}</a>
                        <p class="text-slate-50 mb-2">{{post.createdAtFormat}}</p>
                    </div>
                    <p class="text-slate-50 mb-2 whitespace-pre-wrap">{{post.content}}</p>

                    <div class="flex justify-between text-sky-400">
                        <div (click)="handleOpenComment($event, post)">Comment</div>
                        <div>Like</div>
                        <div>Share</div>
                    </div>
                    <!-- {{post._id}} -->
                </div>

            </div>

            <div *ngIf="post.openComment" class="flex flex-row">

                <div class="flex flex-col mr-4">
                    <img class="rounded-full w-12 h-12"
                        src="https://www.bostonmagazine.com/wp-content/uploads/sites/2/2021/08/rubber-duck-stock-t.jpg" />

                    <div *ngIf="comments.length > 0 && post.openComment" class="flex-1 mt-2 ml-auto mr-auto bg-slate-50 w-px mb-2"></div>
                </div>


                <form class="flex-1 h-24 relative" [formGroup]="form" (ngSubmit)="createComment($event, post)">

                    <textarea class="text-lg w-full h-24 bg-slate-800 text-slate-50 resize-none outline-0"
                        placeholder="Your reply" formControlName="content" required></textarea>
                    <div class="absolute bottom-0 w-full flex justify-end">
                        <button class="text-slate-50" type="submit" mat-flat-button>Post comment</button>
                    </div>

                </form>

            </div>

            <div *ngFor="let comment of comments">

                <div class="flex flex-row">
                    <div class="flex flex-col mr-4">
                        <img class="rounded-full w-12 h-12"
                            src="https://www.bostonmagazine.com/wp-content/uploads/sites/2/2021/08/rubber-duck-stock-t.jpg" />
    
                        <div class="flex-1 mt-2 ml-auto mr-auto bg-slate-50 w-px mb-2"></div>
                    </div>
    
                    <div class="flex flex-col flex-1">
                        <div class="flex flex-row">
                            <a
                                class="text-slate-50 font-bold mr-4 hover:underline pointer cursor-pointer">@{{comment.user.username}}</a>
                            <p class="text-slate-50 mb-2">{{comment.createdAtFormat}}</p>
                        </div>
                        <p class="text-slate-50 mb-2 whitespace-pre-wrap">{{comment.content}}</p>
    
                    </div>
                </div>

            </div>

        </div>
    </div>

</div>